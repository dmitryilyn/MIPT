# Чат-бот Джо Триббиани

В репозитории находятся два ноутбука - один содержит код обработки датасета и обучения, а второй - примеры запуска ата на Gradio с асинхронным выводом, а также телеграм-бота с синхронным выводом. Сам телеграм-бот доступен по ссылке: https://t.me/JoeyGeneratorBot

# 1. Описание модели

Модель PeftModelForCausalLM представляет собой адаптивную версию языковой модели, базирующуюся на архитектуре LLaMA (Llama For Causal Language Modeling), дополненную механизмом LoRA (Low-Rank Adaptation) для эффективной тонкой настройки. LoRA позволяет специализировать модель под конкретные задачи, обновляя лишь небольшую часть параметров, что делает процесс обучения более быстрым и экономичным, сохраняя при этом общую структуру и веса предварительно обученной модели.

### Ключевые компоненты модели:
- LoraModel: Обертка, интегрирующая LoRA с базовой моделью LLaMA.
- LlamaForCausalLM: Специализированная для генерации текста модель на базе LLaMA.
- LoRA: Техника адаптации, позволяющая изменять небольшое число параметров для специализации модели.
- LlamaDecoderLayer и LlamaAttention: Основные блоки, состоящие из слоев внимания и многослойного перцептрона (MLP), обогащенные LoRA-адаптациями.

### Основа - Tiny LLaMA (tinyllama-15M):
В основе PeftModelForCausalLM лежит модель LLaMA, в частности, вариант Tiny LLaMA с ~15 миллионами параметров. Tiny LLaMA представляет собой уменьшенную версию мощных моделей на основе трансформеров, предназначенную для задач обработки естественного языка. Несмотря на относительно малый размер, Tiny LLaMA способна демонстрировать высокое качество генерации текста и понимания языка благодаря эффективной архитектуре и предварительному обучению на большом корпусе текстов. Интеграция с LoRA позволяет дополнительно адаптировать модель под конкретные задачи с минимальными затратами на переобучение.

# 2. Асинхронный вывод с Gradio
Несмотря на то что в Gradio присутствует специализированный ChatInterface, он не поддерживает асинхронный вывод (стриминг), поэтому для тестирования асинхронного вывода я использовал обычный Gradio Interface.

# 3. Телеграм-бот
Телегам-бот использует синхронный вывод.


